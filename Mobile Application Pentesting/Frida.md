Starting Frida Server (victim)
```bash
/data/local/tmp/frida-server
```
Installed applications on device
```bash
frida-ps -Uia
```
Injecting Javascript script at the start of target process 
```bash
frida -U -f owasp.mstg.uncrackable1 -l bypass-root.js
```
Injecting Javascript on an already running process
```bash
frida -U -p 11316 -l bypass-root.js
```
Tracing all class and methods of the application
```bash
frida-trace -U <APP_NAME> -j "*<PACKAGE_NAME*!*"
frida-trace -U 'Frida 0x1' -j "*com.ad2001.frida0x1*!*"
```
Tracing only one method
```bash
frida-trace -U <APP_NAME> -k "*!*<METHOD>*"
```
## Injected Code
Custom Injected code
```js
Java.perform(function() {
  var classRef = Java.use("<package_name>.<class>");
  classRef.<method_to_hook>.implementation = function(args) {
    // Custom logic to execute when the method is called
  }
});
```
Sample:
```js
Java.perform(function() {
  var MainActivity = Java.use("com.mobilehackinglab.fridaone.MainActivity");
  MainActivity.generateRandomNumber.implementation = function(args) {
    // Custom logic to execute when the method is called
    console.log("Intercepted the generateRandomNumber method.");
    console.log("Returning 1337...")
    return 1337
  }
});
```
Calling a method directly
```javascript
var class_reference = Java.use("<package_name>.<class>");
var class_instance = class_reference.$new(); // Class Object if method not static
class_instance.<method>(); // Calling the method
```
Updating static variable
```js
classRef.<variable>.value = <value>
```
Runtime usage of object instances
```js
  Java.choose('<Package>.<Class_Name>', {
    onMatch: function(instance) {
      // TODO
    },
    onComplete: function() {}
  });
```
Constructor hooking
```javascript
Java.perform(function() {
  var a =  Java.use("com.mobilehackinglab.FridaSeven.Checker");
  a.$init.implementation = function(param){
    this.$init(234, 432);
  }
});
```
## Native Library Hooking
- [ ] Ghidra decompile native library, find vulnerable library function
- [ ] `Process.getModuleByName(<TARGET LIBRARY>)`
- [ ] Address of vulnerable export (function)
- [ ] Hooking to the vulnerable function
```js
var libFridaNine = Process.getModuleByName('libFridaNine.so')
var address = libFridaNine.enumerateExports()[0]['address']
Interceptor.attach(address, {
    onEnter: function() {
        console.log("Attached to native flag successfully!")
    },
    onLeave: function(retval) {
        console.log("Original return val:", retval)
        retval.replace("623")
        console.log("Updated return val:", retval)
    }
})
```
- Calculating address
```
- enumerateExports()
- findExportsByName('')
- Ghidra decompile, get address at function (first asm instruction) - base (0x00100000) = offset
  Process.getModuleByName('libFridaNine.so').base.add(offset)
```
Calling native function
- NativeFunction(address_of_native_func, ret_data_type, parameter_data_type)
```js
var adr = Process.getModuleByName("libFridaTen.so").base.add(0x206C0); // Address of the getFlag() function
var get_flag_ptr = new NativePointer(adr);
const get_flag = new NativeFunction(get_flag_ptr, 'pointer', ['int']);
var flag = get_flag(123);
var str = flag.readUtf8String();
console.log("FLAG : " + str);
```
