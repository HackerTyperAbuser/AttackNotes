#!/usr/bin/env python3

import requests
import sys
from colorama import Fore, Style
import argparse

# Disable SSL warnings
requests.packages.urllib3.disable_warnings(
    requests.packages.urllib3.exceptions.InsecureRequestWarning
)

def format_text(title, item):
    cr = '\r\n'
    section_break = cr + "*" * 20 + cr
    item = str(item)
    text = Style.BRIGHT + Fore.RED + title + Fore.RESET + section_break + item + section_break
    return text

def main():
    # Parse arguments
    parser = argparse.ArgumentParser(description='Base HTTP template')
    parser.add_argument('target', help='Target URL, you need to add / at the end')
    parser.add_argument('--proxy', action='store_true', help='Proxy through localhost:8080 (Burp Suite)')
    parser.add_argument('--payload', action='store_true', help='adding payloads')
    args = parser.parse_args()
    
    target = args.target
    payload = args.payload


    # Add https:// if not present
    if not target.startswith(('http://', 'https://')):
        target = 'https://' + target
    
    # Setup proxy if flag is set
    proxies = None
    if args.proxy:
        proxies = {
            'http': 'http://127.0.0.1:8080',
            'https': 'http://127.0.0.1:8080'
        }
        print(f"{Fore.YELLOW}[*] Using proxy: 127.0.0.1:8080{Fore.RESET}\n")
    
    try:
        # GET request
        r = requests.get(f'{target}{payload if payload else ""}', verify=False, timeout=10, proxies=proxies)

        # POST request example (uncomment if needed)
        # data = {'key': 'value'}  # Example payload for POST request
        # r = requests.post(f'{target}{payload if payload else ""}', data=data, verify=False, timeout=10, proxies=proxies)
        
        # PUT request example (uncomment if needed)
        # r = requests.put(f'{target}{payload if payload else ""}', data=data, verify=False, timeout=10, proxies=proxies) 

        # Print results
        print(format_text('r.status_code is: ', r.status_code))
        print(format_text('r.headers is: ', r.headers))
        print(format_text('r.cookies is: ', r.cookies))

        print("============================= RESPONSE ==================================\n")
        print(format_text('r.text is: ', r.text))
        print("===============================================================\n")
        
    except requests.exceptions.RequestException as e:
        print(f"{Fore.RED}Error: {e}{Fore.RESET}")
        sys.exit(1)

if __name__ == '__main__':
    main()