# Session Hijacking

Using valid session cookie to takeover victim session and act as the victim.

# Session Fixation

Attacker fixate a valid session identifier, the attacker will then trick the victim into logging into the application using the aforementioned session identifier. If the victim does so session can be hijacked.

## Testing

1. Attacker obtain a valid session (either just by browsing or by creating an account).
2. The above behavior is expected. Vulnerability arises if
    1. Assigned session identifier pre-login remains the same post-login.
    2. Session identifiers are accepted from URL query Strings or Post Data and propagated to the application
3. Craft a URL send to victim for which session identifier can be fixated to the victim.

## Obtaining Session (Wireshark)

If HTTP is used instead of HTTPs, requests and responses are sent in plaintext.
- An attacker can sniff the traffic and obtain valid session identifiers.
![](../../img/Pasted%20image%2020260212020837.png)

# Obtaining Session (Post-Exploitation)

## Web Server Access

Session identifiers may be stored within web server files.

**PHP**
- Finding where session is stored
```shell
locate php.ini
cat /etc/php/7.4/cli/php.ini | grep "session.save_path"
cat /etc/php/7.4/apache2/php.ini | grep 'session.save_path'
```

From here files containing valid sessions of users can be found â†’ assist with enumeration and exploitation.

## Database Access

Sometimes sessions may be stored in databases as well.
- Always good to find for valid sessions before credentials.
![](../../img/Pasted%20image%2020260212020844.png)